var Application=function(a){this.init(a)};Application.prototype={init:function(a){this.lang=a.lang;this.absoluteContentContextPath=a.absoluteContentContextPath;this.relativeContentContextPath="/content";this.absoluteResourcePath=a.absoluteResourcePath;this.relativeResourcePath="/content/inc";this.absoluteGrailsContextPath=a.absoluteGrailsContextPath;this.absoluteGrailsSecurityContextPath=a.absoluteGrailsSecurityContextPath;this.relativeGrailsContextPath="/dme";this.windowsLiveAuthServerURL=a.windowsLiveAuthServerURL;this.windowsLiveClientId=a.windowsLiveClientId;this.googleAnalyticsTrackingId=a.googleAnalyticsTrackingId;this.googleAnalyticsTrackingDomain=a.googleAnalyticsTrackingDomain;this.loadServerInfo()},loadServerInfo:function(){var a;var b=this;$.ajax({type:"GET",async:false,url:b.relativeGrailsContextPath+"/security/serverInfo",data:"field=grailsServerURL&field=grailsContextPath&field=grailsSecurityServerURL&field=grailsSecurityContextPath&field=contentServerURL&field=contentContextPath&field=resourcePath&field=windowsLiveAuthServerURL&field=windowsLiveClientId&field=googleAnalyticsTrackingId&field=googleAnalyticsTrackingDomain",success:function(c){b.absoluteContentContextPath=c.contentServerURL+b.relativeContentContextPath;b.absoluteResourcePath=c.resourcePath;b.absoluteGrailsContextPath=c.grailsServerURL+b.relativeGrailsContextPath;b.absoluteGrailsSecurityContextPath=c.grailsSecurityServerURL+b.relativeGrailsContextPath;b.windowsLiveAuthServerURL=c.windowsLiveAuthServerURL;b.windowsLiveClientId=c.windowsLiveClientId;b.googleAnalyticsTrackingId=c.googleAnalyticsTrackingId;b.googleAnalyticsTrackingDomain=c.googleAnalyticsTrackingDomain;a=true},error:function(c,e,d){a=false}});return a},getContentContextPath:function(){if(!!this.absoluteContentContextPath){return this.absoluteContentContextPath}else{if(this.loadServerInfo()){return this.absoluteContentContextPath}else{return this.relativeContentContextPath}}},getRelativeContentContextPath:function(){return this.relativeContentContextPath},getResourcePath:function(){if(!!this.absoluteResourcePath){return this.absoluteResourcePath}else{if(this.loadServerInfo()){return this.absoluteResourcePath}else{return this.relativeResourcePath}}},getRelativeResourcePath:function(){return this.relativeResourcePath},getGrailsContextPath:function(){if(!!this.absoluteGrailsContextPath){return this.absoluteGrailsContextPath}else{if(this.loadServerInfo()){return this.absoluteGrailsContextPath}else{return this.relativeGrailsContextPath}}},getRelativeGrailsContextPath:function(){return this.relativeGrailsContextPath},getGrailsSecurityContextPath:function(){if(!!this.absoluteGrailsSecurityContextPath){return this.absoluteGrailsSecurityContextPath}else{if(this.loadServerInfo()){return this.absoluteGrailsSecurityContextPath}else{return this.relativeGrailsContextPath}}},getWindowsLiveAuthServerURL:function(){if(!!this.windowsLiveAuthServerURL){return this.windowsLiveAuthServerURL}else{if(this.loadServerInfo()){return this.windowsLiveAuthServerURL}else{return"https://login.live.com"}}},getWindowsLiveClientId:function(){if(!!this.windowsLiveClientId){return this.windowsLiveClientId}else{if(this.loadServerInfo()){return this.windowsLiveClientId}else{return"000000004C0B6BDB"}}},getGoogleAnalyticsTrackingId:function(){if(!!this.googleAnalyticsTrackingId){return this.googleAnalyticsTrackingId}else{if(this.loadServerInfo()){return this.googleAnalyticsTrackingId}else{return"UA-32238617-1"}}},getGoogleAnalyticsTrackingDomain:function(){if(!!this.googleAnalyticsTrackingDomain){return this.googleAnalyticsTrackingDomain}else{if(this.loadServerInfo()){return this.googleAnalyticsTrackingDomain}else{return"foglight-on-demand.com"}}},getLang:function(){return this.lang},setLang:function(a){this.lang=a},getYear:function(){return"2013"},signOut:function(){location.href=this.getGrailsContextPath()+"/j_security_logout"},exitSwitchedUser:function(){location.href=this.getGrailsContextPath()+"/j_security_exit_user"},isIPad:function(){return navigator.userAgent.indexOf("iPad")!=-1},isTablet:function(){return window.screen.width<=1366}};var Banner=function(){var e=$("#banner");var x=$("#banner-solutions>ul");var s=$("#banner-solutions>ul").find("li.solution").length;var g=e.find(".solution-scenarios");var c=0;var o="easeInOutExpo";var k=5000;var u=2;var i=0;var b=false;var l;var n=false;var q=function(){d();a();w();f();h();r()};var d=function(){var z=$(window).width();var y=x.find("li.solution");y.width(z);x.width(z*(s+1));x.css("left",-z*c)};var a=function(){$("#banner-solution-nav li").click(function(){googleAnalyticsTrackPageview("/content/en/home/"+$(this).attr("id")+".html");var y=$(this).index();v(y)})};var v=function(z){if(n||z==c){return}n=true;var E=m(c);if(E.hasClass("banner-solution-clone")){c=0;z=c+1;E=m(c);x.css("left",0)}$("#banner-solution-nav li").removeClass("selected");$("#banner-solution-nav li").eq(z%s).addClass("selected");var C=$(window).width();var B=E.find(".solution-content");var y=B.width();var A=-(y+(C-y)/2);B.stop(true,true).animate({left:A},{duration:1400,easing:o});var D=-C*z;x.stop(true,true).animate({left:D},{duration:2000,easing:o,complete:function(){B.css("left",0);c=z;n=false}})};var m=function(y){var z=x.find("li.solution");return z.eq(c)};var t=function(){var y=m(0).clone(true);y.addClass("banner-solution-clone");y.appendTo(x)};var r=function(){t();l=setInterval(function(){j()},k)};var j=function(){if(b){return}var y=c+1;var z=m(y);if(z.hasClass("banner-solution-clone")){i++}if(i>=u){clearInterval(l);return}v(y)};var h=function(){e.hover(function(){b=true},function(){b=false})};var w=function(){$(window).resize(function(){p();d()})};var p=function(){var z=m(c);var y=z.find(".solution-content");y.stop(true,true);x.stop(true,true)};var f=function(){g.find("li").click(function(){var y=$(this).attr("_scenario");if(y){googleAnalyticsTrackPageview("/content/en/"+y);window.location.assign(y)}})};return{init:q}};var underConstrunctionEmailTo="FoglightOnDemand@quest.com";var pricingConstructionTip="<p>We will announce pricing shortly and you will be given 30 days usage from that time.</p> <p>In the meantime please enjoy using our service for free.</p>";var subscribeConstructionTip="<p>We will be introducing paid subscriptions shortly. You will be given 30 days notice at that point.</p> <p>In the meantime please enjoy using our offering for free.</p>";var isTablet=navigator.userAgent.indexOf("iPad")!=-1;var platforms={Azure:"Azure",Amazon:"Amazon Web Services",Heroku:"Heroku",EngineYard:"Engine Yard",VMware:"VMware",HyperV:"Hyper-V"};function hightLightEngineTypeMenu(d){var a={dme:"",vmware:"for VMware",hyperV:"for Hyper-V",azure:"for Azure Apps",websites:"for Web Sites",oracle:"for Oracle"};var c={dme:"dme",vmware:"infra",hyperV:"infra",azure:"app",websites:"user"};$("#"+c[d]).addClass("active").siblings().removeClass("active");if(d==null||d==undefined||d==""){d="dme"}var b=a[d];if(b!=null&&b!=undefined&&b!=""){$("#logo span").text(b).show()}else{d="dme"}if(d!="dme"){$("#logo").attr({href:application.getContentContextPath()+"/"+application.getLang()+"/"+d+"/index.html"})}else{$("#logo").attr({href:application.getContentContextPath()+"/"+application.getLang()+"/index.html"})}}function highlightMenuItem(a){$("#"+a).addClass("active").siblings().removeClass("active")}function popLayerAlignedCenter(h){var a=$(window).height();var e=$(window).width();var d;if(h){d=$("#"+h)}else{d=$(".pop-layer")}var c=d.height();var b=d.width();d.css({position:"fix",top:(a-c)/2,left:(e-b)/2});var f=$(document).height();var g=$(document).width();$("#layer-mask").css({height:f,width:g})}function isShowByOS(){var b=true;var e=$.client.os;var c=new Array("Android","iPhone","iPad");var a=c.length;for(var d=0;d<a;d++){if(c[d]==e){b=false;break}}return b}$(function(){if(!isShowByOS()){$(".reportOnThis").hide()}$(".underConstructionTrigger").click(function(){$("#underConstruction").remove();var i=$(window).width();var f=$(window).height();var d=$(this).offset().left;var b=$(this).offset().top;var e=$(window).scrollLeft();var a=$(window).scrollTop();var g=$(this).height();var c=(d-e+332+16)<=i?(d):(i+e-332-16);var h=(b-a+g+221+16)<=f?(b+g):(b-221-16);return false});$(document).click(function(b){var c=b||window.event;var a=c.srcElement||c.target;while(a){if(a.id=="underConstruction"){return}a=a.parentNode}$("#underConstruction").hide()});$(".pricingConstructionTrigger").click(function(){var e=$(this).offset().left;var b=$(this).offset().top;var g=$("<div class='underConstruction'><h2 class='underConstructionTitle'>Pricing Coming Soon</h2><div class='underConstructionWrapper'>"+pricingConstructionTip+"<img src='"+application.getResourcePath()+"/img/icon-close.png' class='underConstructionClose' id='underConstructionClose' width='23' height='23' title='"+getI18NMessage("btn.close.label")+"' alt='"+getI18NMessage("btn.close.label")+"' onclick='$(this).parent().parent().remove();'/></div></div>");$("body").append(g);var j=$(window).width();var c=$(window).height();var f=$(window).scrollLeft();var a=$(window).scrollTop();var h=$(this).height();var d=(e-f+332+16)<=j?(e):(j+f-332-16);var i=(b-a+h+221+16)<=c?(b+h):(b-221-16);g.css("left",d+"px").css("top",i+"px")});$(".subscribeConstructionTrigger").click(function(){var e=$(this).offset().left;var b=$(this).offset().top;var i=$("<div class='underConstruction'><h2 class='underConstructionTitle'>Subscriptions Coming Soon</h2><div class='underConstructionWrapper'>"+subscribeConstructionTip+"<img src='"+application.getResourcePath()+"/img/icon-close.png' class='underConstructionClose' id='underConstructionClose' width='23' height='23' title='"+getI18NMessage("btn.close.label")+"' alt='"+getI18NMessage("btn.close.label")+"' onclick='$(this).parent().parent().remove();'/></div></div>");$("body").append(i);var j=$(window).width();var c=$(window).height();var f=$(window).scrollLeft();var a=$(window).scrollTop();var g=$(this).height();var d=(e-f+332+16)<=j?(e):(j+f-332-16);var h=(b-a+g+221+16)<=c?(b+g):(b-221-16);i.css("left",d+"px").css("top",h+"px")})});var IframeOnClick={resolution:200,iframes:[],interval:null,Iframe:function(){this.element=arguments[0];this.cb=arguments[1];this.hasTracked=false},track:function(b,a){if(!!b){this.iframes.push(new this.Iframe(b,a));if(!this.interval){var c=this;this.interval=setInterval(function(){c.checkClick()},this.resolution)}}},checkClick:function(){if(document.activeElement){var b=document.activeElement;for(var a in this.iframes){if(b===this.iframes[a].element){if(this.iframes[a].hasTracked==false){this.iframes[a].cb.apply(window,[]);this.iframes[a].hasTracked=true}}else{this.iframes[a].hasTracked=false}}}}};$(document).ready(function(){IframeOnClick.track(document.getElementById("vFoglightFrame"),function(){$("#underConstruction").hide()});$(document).keyup(function(a){if(27==a.keyCode){$("#mask, .popLayer, .underConstruction").hide();　　　　　　;　　}})});function parseURL(d){var b=document.createElement("a");b.href=d;var c="";if(d.indexOf("#")>0){c=d.substr(d.indexOf("#"))}return{anchor:c,source:d,protocol:b.protocol.replace(":",""),host:b.hostname,port:b.port,query:b.search,sourceWithoutQuery:d.replace(b.search,"").replace(c,""),params:(function(){var f={},e=b.search.replace(/^\?/,"").split("&"),a=e.length,g=0,h;for(;g<a;g++){if(!e[g]){continue}h=e[g].split("=");f[h[0]]=h[1]}return f})(),file:(b.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:b.hash.replace("#",""),path:b.pathname.replace(/^([^\/])/,"/$1"),relative:(b.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:b.pathname.replace(/^\//,"").split("/")}}function writeCookie(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m=$.extend({},m);m.expires=-1}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+(m.path):"";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}}function isEmail(b){var a=/^[\w\-\.]+@[\w\-\.]+(\.\w+)+$/;if(a.test(b)){return true}else{return false}}function ajaxSend(b,d,c){if(!d||!c){return}var a=new Object();a.tempOpen=b.prototype.open;a.tempSend=b.prototype.send;if(d){a.beforeCallback=function(){d(this.method,this.url,this.data)}}if(c){a.afterCallback=function(){c(this.method,this.url,this.data)}}b.prototype.open=function(f,e){if(!f){var f=""}if(!e){var e=""}a.tempOpen.apply(this,arguments);a.method=f;a.url=e;if(f.toLowerCase()=="get"){a.data=e.split("?");a.data=a.data[1]}};b.prototype.send=function(f,e){if(!f){var f=""}if(!e){var e=""}if(a.beforeCallback){a.beforeCallback()}a.tempSend.apply(this,arguments);if(a.method.toLowerCase()=="post"){a.data=f}if(a.afterCallback){a.afterCallback()}}}function getType(b){var a;return((a=typeof(b))=="object"?Object.prototype.toString.call(b).slice(8,-1):a).toLowerCase()}function loadScript(b,d,e){var c=document.getElementsByTagName("head")[0];var a=document.createElement("script");a.type="text/javascript";a.async=d;a.onload=a.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){if(!!e){try{var h=getType(e);if(h=="string"){var f=new Function(e);f()}else{if(h=="function"){e()}}}catch(g){}}a.onload=a.onreadystatechange=null}};a.src=b;c.appendChild(a)}function googleAnalyticsTrackPageview(a){_gaq.push(["_trackPageview",a])}function log(){var a=false;if(a){if($.browser.msie){$.each(arguments,function(b,c){alert(c)})}else{if($.browser.mozilla||$.browser.safari||$.browser.opera){$.each(arguments,function(b,c){console.log(c)})}else{}}}}var ExternalOAuth2Login=function(b){var a;this.init(b)};ExternalOAuth2Login.prototype={init:function(a){this.callbackURIPrefix="/externalAuthenticationLogin/authSuccess/";this.externalOAuth2LoginInstanceName="externalOAuth2Login";if(!!a){if(!!a.externalOAuth2LoginInstanceName){this.externalOAuth2LoginInstanceName=a.externalOAuth2LoginInstanceName}this.jExternalSecurityCheckOverride=a.jExternalSecurityCheck}},login:function(f,b,i,j){if(!j){j=""}if(f=="WindowsLive"){var e=function(k){if(k=="zh"){return"zh-cn"}return k};var d=b;var h=new Date().getTime();var g="token";var c={};c.client_id=application.getWindowsLiveClientId();c.display=d;c.locale=e(application.getLang());c.redirect_uri=application.getGrailsContextPath()+this.callbackURIPrefix+f+"/"+b+"/"+i+"/"+j+"?externalOAuth2LoginInstanceName="+this.externalOAuth2LoginInstanceName;c.response_type=g;c.scope="wl.signin wl.emails wl.phone_numbers wl.work_profile";c.state="display="+d+"&request_ts="+h+"&response_type="+g+"&secure_cookie=false";var a=application.getWindowsLiveAuthServerURL()+"/oauth20_authorize.srf?"+this.serializeParameters(c);if(b=="popup"){this.openAuthPopUp(a,f,525,475)}else{window.location.assign(a)}}},openAuthPopUp:function(b,c,d,o){var m;var j;if($.browser.msie){var k=window.screenLeft,g=window.screenTop,i=document.documentElement,l=30;j=k+(i.clientWidth-d)/2;m=g+(i.clientHeight-o)/2-l}else{var h=window.screenX,f=window.screenY,p=window.outerWidth,n=window.outerHeight;j=h+(p-d)/2;m=f+(n-o)/2}var e=["width="+d,"height="+o,"top="+m,"left="+j,"status=no","resizable=yes","toolbar=no","menubar=no","scrollbars=yes"];if($.browser.msie){window.open(b,"foglightOnDemand_"+c,e.join(","));this._startCookieWatcher()}else{var a=window.open(b,"foglightOnDemand_"+c,e.join(","));this._startCookieWatcher();a.focus();return a}},_startCookieWatcher:function(){var b=this;if(!!b.cookieWatcherStarted){return}else{b.cookieWatcherStarted=true;var a=setInterval(function(){var c=writeCookie("j_external_origin");var f=writeCookie("j_external_callbackURL");if(!!c&&!!f){var d=new Date();d.setTime(d.getTime()-10000);var e=d;writeCookie("j_external_origin",null,{expires:e,path:"/"});writeCookie("j_external_callbackURL",null,{expires:e,path:"/"});b.jExternalSecurityCheckWithCallbackURL(c,f);clearInterval(a);b.cookieWatcherStarted=false}},200)}},jExternalSecurityCheck:function(a,b){if(!!this.jExternalSecurityCheckOverride){this.jExternalSecurityCheckOverride(a,b);return}var c={};c.j_external_origin=a;c.j_external_token=b;if(this.jExternalSecurityCheckSuccessCallbackUrl){c.j_security_redirect=this.jExternalSecurityCheckSuccessCallbackUrl}location.href=application.getGrailsContextPath()+"/j_external_security_check?"+$.param(c)},setJExternalSecurityCheckSuccessCallbackUrl:function(a){this.jExternalSecurityCheckSuccessCallbackUrl=a},jExternalSecurityCheckWithCallbackURL:function(b,a){var c=this._extractExternalAuthenticationAccessToken(b,a);this.jExternalSecurityCheck(b,c)},_extractExternalAuthenticationAccessToken:function(d,b){if(d=="WindowsLive"){var e=b.indexOf("?")+1;var a=b.indexOf("#")+1;var f={};if(e>0){var c=(a>e)?(a-1):b.length;f=this.deserializeParameters(b.substring(e,c),f)}if(a>0){f=this.deserializeParameters(b.substring(a),f)}return f.access_token}},loginSuccess:function(f,b,h,i){var c=location.href;if(h=="Desktop"){if(!!i){var g=this;var e=this._extractExternalAuthenticationAccessToken(f,c);$.ajax({type:"POST",async:false,url:application.relativeGrailsContextPath+"/externalAuthenticationExchangeToken/register",data:{preGeneratedToken:i,externalAuthenticationAccessToken:e},success:function(l){var j=10;var k=setInterval(function(){j--;if(j==0){$("#windowKeepAliveSeconds").text(j);clearInterval(k);g.closeSelfWindow()}else{$("#windowKeepAliveSeconds").text(j)}},1000)}})}}else{if(b=="popup"){var a=new Date();a.setTime(a.getTime()+60*1000);var d=a;writeCookie("j_external_origin",f,{expires:d,path:"/"});writeCookie("j_external_callbackURL",c,{expires:d,path:"/"});this.closeSelfWindow()}else{this.jExternalSecurityCheckWithCallbackURL(f,c)}}},closeSelfWindow:function(){if($.browser.msie){var a=window.open("","_self","","true");a.close()}else{if($.browser.webkit){window.open("","_self","");window.close()}else{window.close()}}},deserializeParameters:function(d,e){var f=(e!=null)?e:{};if(d!=null){var b=d.split("&");for(var a=0;a<b.length;a++){var c=b[a].split("=");if(c.length==2){f[decodeURIComponent(c[0])]=decodeURIComponent(c[1])}}}return f},serializeParameters:function(e){var d="";if(e!=null){for(var a in e){var c=(d.length==0)?"":"&";var b=e[a];d+=c+encodeURIComponent(a)+"="+encodeURIComponent(this.stringifyParamValue(b))}}return d},stringifyParamValue:function(a){if(a instanceof Date){var b=function(e,d){switch(d){case 2:return e<10?"0"+e:e;case 3:return(e<10?"00":(e<100?"0":""))+e}};return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1,2)+"-"+b(a.getUTCDate(),2)+"T"+b(a.getUTCHours(),2)+":"+b(a.getUTCMinutes(),2)+":"+b(a.getUTCSeconds(),2)+"."+b(a.getUTCMilliseconds(),3)+"Z"}return""+a}};var Feedback=function(a){this.init(a)};Feedback.prototype={init:function(a){this.product=a.product;this.module=a.module;this.mFunction=a.mFunction;this.rateType=a.rateType;this.rate=a.rate;this.feedback=a.feedback;this.engineType=a.engineType;this.lang=application.getLang();var b=this;$.ajax({type:"GET",async:false,url:application.getRelativeGrailsContextPath()+"/feedback/feedback",data:"product="+this.product+"&module="+this.module+"&mFunction="+this.mFunction+"&rateType="+this.rateType+"&rate="+this.rate+"&feedback="+this.feedback+"&engineType="+this.engineType+"&lang="+this.lang,success:function(d){$("#feedbackWrapper").remove();$("#confusedPopLayer").remove();$(d).appendTo($("body"));var c=parseURL(window.location.href);var e=c.protocol;if(e=="https"){$("#shareThis").addClass("vhidden");$("#feedback").addClass("bottom")}b.initFeedbackConfusedPosition()}})},initFeedbackConfusedPosition:function(){var a=$(window).height();var d=$(window).width();var c=$("#confusedPopLayer").width();var b=$("#confusedPopLayer").height();$("#confusedPopLayer").css({top:(a-b)/2,left:(d-c)/2});$("#mask").css({height:$(document).height(),width:$(document).width()})},refresh:function(a){}};(function(g,f){var j=function(b){return b.innerHTML="<x-element></x-element>",b.childNodes.length===1}(f.createElement("a")),i=function(e,d,k){return d.appendChild(e),(k=(k?k(e):e.currentStyle).display)&&d.removeChild(e)&&k==="block"}(f.createElement("nav"),f.documentElement,g.getComputedStyle),h={elements:"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video".split(" "),shivDocument:function(b){b=b||f;if(b.documentShived){return}b.documentShived=!0;var l=b.createElement,k=b.createDocumentFragment,e=b.getElementsByTagName("head")[0],d=function(m){l(m)};j||(h.elements.join(" ").replace(/\w+/g,d),b.createElement=function(n){var m=l(n);return m.canHaveChildren&&h.shivDocument(m.document),m},b.createDocumentFragment=function(){return h.shivDocument(k())});if(!i&&e){var c=l("div");c.innerHTML=["x<style>","article,aside,details,figcaption,figure,footer,header,hgroup,nav,section{display:block}","audio{display:none}","canvas,video{display:inline-block;*display:inline;*zoom:1}","[hidden]{display:none}audio[controls]{display:inline-block;*display:inline;*zoom:1}","mark{background:#FF0;color:#000}","</style>"].join(""),e.insertBefore(c.lastChild,e.firstChild)}return b}};h.shivDocument(f),g.html5=h})(this,document);var Inprogress=function(a){this.init(a)};Inprogress.prototype={init:function(a){this.id=a.id;if(!this.id){return}this.bindWindowResizeEvent()},show:function(){if($("#layer-mask").length==0){var a=[];a.push('<div id="layer-mask"></div>');$("body").prepend(a.join(""))}$("#layer-mask").show();$("#"+this.id).show();popLayerAlignedCenter(this.id)},hide:function(){$("#layer-mask").hide();$("#"+this.id).hide()},bindWindowResizeEvent:function(){$(window).resize(function(){popLayerAlignedCenter(this.id)})}};function writeLiveChat(){if(!$.trim($("#liveChat").html())){Comm100API=Comm100API||{chat_buttons:[]};Comm100API.chat_buttons.push({code_plan:2501,div_id:"liveChat"});Comm100API.site_id=121489;Comm100API.main_code_plan=2501;(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src="https://chatserver.comm100.com/livechat.ashx?siteId="+Comm100API.site_id;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)})()}return Comm100API}var LoginPopup=function(a){var p=a?a:{};var o=function(){g();i();n();k()};var b=function(){window.location.assign(l)};var m=function(q){b=q};var l=p.successCallbackUrl;var d=function(q){l=q};var i=function(){$("#_login").live("click",function(q){j()});$("#login_passWord").live("keydown",function(q){if(q.keyCode==13){j()}})};var j=function(){$("#loginError").hide();if($("#loginForm").valid()){$.ajax({type:"POST",url:application.getRelativeGrailsContextPath()+"/j_security_check",data:{userName:$("#login_userName").val(),passWord:$("#login_passWord").val(),entryPoint:$("input:radio[name=entryPoint]:checked").val(),j_security_remember_me:$("#rememberMeMore:checked").val()},success:function(s){var q=s.success;if(true==q){b()}else{var r=s.messages;var t="";if(r.errorUserName!=null&&r.errorUserName!=undefined){t+=r.errorUserName}else{if(r.errorPassword!=null&&r.errorPassword!=undefined){t+=r.errorPassword}else{if(r.errorCredentials!=null&&r.errorCredentials!=undefined){t+=r.errorCredentials}}}e(t)}},error:function(q,s,r){e(s)}})}};var e=function(q){$("#loginError").html(q);$("#loginError").show()};var h=function(q,r){$.ajax({type:"GET",url:application.getRelativeGrailsContextPath()+"/security/isLoggedIn",data:{entryPoint:"ENTRY_CUSTOMER"},success:function(s){if(s=="true"){q()}else{r()}},error:function(s,u,t){r()}})};var c=function(){if($("#layer-mask").length==0){var q=[];q.push('<div id="layer-mask" _span="mask"></div>');$("body").prepend(q.join(""))}$("[_span=mask]").show();$("#logForSub").show();$("#loginDiv").show();$("#signupDiv").hide();f()};var g=function(){$("[_span=mask],#closeLogForSub").click(function(){$("#loginDiv").hide();$("#signupDiv").hide();$("#logForSub").hide();$("[_span=mask]").hide();var r=$("#loginForm").validate();r.resetForm();var q=$("#signupForm").validate();q.resetForm();$("#login_userName").val("");$("#userName").val("");$("#login_passWord").val("");$("#rememberMeMore").attr({checked:false});$("#passWord").val("");$("#confirmPassWord").val("");$("#emailAdd").val("");$("#fullName").val("");$("#companyName").val("");$("#phone").val("");$("#acceptBox").attr({checked:false});$("#login_userName,#login_passWord").removeClass("valid");$("#loginError").hide()})};var f=function(){popLayerAlignedCenter("logForSub")};var n=function(){$(window).resize(function(){f()})};var k=function(){$("[_a=windowLiveID]").click(function(){var q=new ExternalOAuth2Login();q.setJExternalSecurityCheckSuccessCallbackUrl(l);q.login("WindowsLive","popup","Web")})};return{init:o,isLogin:h,showLoginDiv:c,setSuccessCallback:m,setSuccessCallbackUrl:d}};$(function(){$("#prodNav").hover(function(){clearTimeout($.data(this,"timer"));$(this).find(".prod-nav-container").stop(true,true).slideDown(200)},function(){$.data(this,"timer",setTimeout($.proxy(function(){$(this).find(".prod-nav-container").stop(true,true).slideUp(200)},this),200))});$("#prodNav ul li").hover(function(){$(this).find(".bg-hover").stop().animate({opacity:"1"},"slow")},function(){$(this).find(".bg-hover").stop().animate({opacity:"0"},"slow")})});$(function(){(function(){var f=$("#ourCustomers");var d=f.find(".our-customers-list");var a=d.find("ul");var c=f.find("li").outerWidth(true);var e=f.find("li").length;var b=3;f.find(".our-customers-next-list").click(function(){if(b<e){a.stop(true,true).animate({left:"-="+c});b++}});f.find(".our-customers-prev-list").click(function(){if(b>3){a.stop(true,true).animate({left:"+="+c});b--}})})()});var PaymentMethod=function(){var i=function(){var u;var v=function(C){if(!C){var A=$("[_hidden_field=paymentType]");if(A.length>0){var B=A.val();if((!B)||(B!="CreditCard")){C=q()}}}if(!C){C={retainValues:true}}$.ajax({type:"POST",url:application.getRelativeGrailsContextPath()+"/zuoraPayment/requestHostedPaymentPageUrl",data:C,success:function(F){var D=F.url;if(D){$("[_iframe=payment_page]").hide();$("[_iframe=payment_page]")[0].src=D;var E=$("[_div=zuoraLoader]");E.show();$("[_iframe=payment_page]").load(function(){E.hide();$("[_iframe=payment_page]").show()})}},error:function(D,F,E){},beforeSend:function(E,D){$("[_div=payment_error]").hide()}})};var q=function(){var A={country:"field_creditCardCountry",address1:"field_creditCardAddress1",city:"field_creditCardCity",state:"field_creditCardState",postalCode:"field_creditCardPostalCode",phone:"field_phone",email:"field_email"};var C={};var B=$("#billToForm :input");B.each(function(E,F){var D=F.name;var H=F.value;if(H){if(D=="state"&&$(F).is("select")){H=$("#billToForm [name=state]").find("option:selected").text()}var G=A[D];C[G]=H}});return C};var p=function(A){if(u){u(A)}};var s=function(A){v();z(A)};var z=function(A){$("._payment_error").hide();$.each(A,function(C,B){if(B){if(C=="errorMessage"){$("[_div=payment_error] [_error="+C+"]").html(B)}$("[_div=payment_error] [_error="+C+"]").show()}});$("[_div=payment_error]").show()};var y=function(){$("input[name=PaymentType][value=CreditCard]").trigger("click")};var w=function(){$("[_div=payByCreditCard]").show();$("[_div=payByPurchaseOrder]").hide();$("[_div=payByCreditCard_summary]").show();$("[_div=payByPurchaseOrder_summary]").hide()};var r=function(A){$("[_hidden_field=paymentType]").val(A.paymentType);$("[_hidden_field=paymentMethodId]").val(A.paymentMethodId);$("[_hidden_field=purchaseOrderNumber]").val("");$.each(A,function(B,C){$("[_span=payment_"+B+"]").html(C)})};var t=function(A){$("[_div=payment_error]").hide();submitHostedPage("z_hppm_iframe");u=A};var x=function(){$("input[name=PaymentType][value=CreditCard]").trigger("click");$("#invoiceForm")[0].reset();$("#invoiceForm").validate().resetForm()};return{requestHostedPaymentPage:v,hostedPageCallbackSuccess:p,hostedPageCallbackFailure:s,init:y,show:w,update:r,submit:t,cancel:x}};var j=function(){var v=function(){return $("#invoiceForm [name=purchaseOrderNumber]").val()};var q=function(w){$("#invoiceForm [name=purchaseOrderNumber]").val(w)};var t=function(w){q(w?w.purchaseOrderNumber:v());$("input[name=PaymentType][value=PurchaseOrder]").trigger("click")};var p=function(){$("[_div=payByCreditCard]").hide();$("[_div=payByPurchaseOrder]").show();$("[_div=payByCreditCard_summary]").hide();$("[_div=payByPurchaseOrder_summary]").show()};var u=function(w){$("[_hidden_field=paymentType]").val(w.paymentType);$("[_hidden_field=purchaseOrderNumber]").val(w.purchaseOrderNumber);$("[_hidden_field=paymentMethodId]").val("");$("[_span=payment_purchaseOrderNumber]").html(w.purchaseOrderNumber);$("[_iframe=payment_page]")[0].src=""};var s=function(x){if($("#invoiceForm").valid()){var w={paymentType:"PurchaseOrder",purchaseOrderNumber:v()};x(w)}};var r=function(){$("input[name=PaymentType][value=PurchaseOrder]").trigger("click");var w=$("[_hidden_field=purchaseOrderNumber]").val();q(w)};return{init:t,show:p,update:u,submit:s,cancel:r}};var a={CreditCard:new i(),PurchaseOrder:new j()};var o=function(){e();c()};var h=function(){var p=$("input[name=PaymentType]:checked").val();return p};var e=function(){$("input[name=PaymentType]").click(function(){$(this).attr("checked","checked");var p=h();a[p].show()})};var g=function(){$("[_iframe=payment_page]")[0].src="";$("input[name=PaymentType][value=CreditCard]").click();$("#invoiceForm")[0].reset();$("#invoiceForm").validate().resetForm()};var n=function(q){var p=q.paymentType;a[p].update(q)};var m=function(q){var p=h();a[p].submit(q)};var c=function(){$("[_btn=modify_payment]").click(function(){l();b(function(){m(function(p){n(p);d()})},function(){var p=$("[_hidden_field=paymentType]").val();a[p].cancel();$("[_iframe=payment_page]")[0].src="";d()});$("[_div=display_payment_method]").hide();$("[_div=edit_payment_method]").show()})};var f=function(){a.CreditCard.requestHostedPaymentPage();a.CreditCard.init()};var l=function(q){if(q){var p=q.paymentType;if(p=="CreditCard"){a.CreditCard.requestHostedPaymentPage(q)}else{a.CreditCard.requestHostedPaymentPage()}a[p].init(q)}else{a.CreditCard.requestHostedPaymentPage();var p=$("[_hidden_field=paymentType]").val()?$("[_hidden_field=paymentType]").val():"CreditCard";a[p].init()}$("[_btn=payment_method_operation_btns]").show()};var b=function(q,p){$("[_btn=confirm_modify_payment_method]").click(function(){q()});$("[_btn=cancel_modify_payment_method]").click(function(){p()})};var d=function(){$("[_div=display_payment_method]").show();$("[_div=edit_payment_method]").hide();$("[_btn=payment_operation_btns]").hide()};var k=function(){$("._step_title").removeClass("selected");$("[_step_title=paymentMethodInfo]").addClass("selected");$("._step_title").removeClass("beforeSelected");$("[_step_title=subscriberInfo]").addClass("beforeSelected");$("._step").hide();$("[_step=payment_method]").show()};return{init:o,show:k,hostedPageCallbackSuccess:a.CreditCard.hostedPageCallbackSuccess,hostedPageCallbackFailure:a.CreditCard.hostedPageCallbackFailure,modifyPaymentMethodInit:l,modifyPaymentMethodHandler:b,paymentMethodSubmitHandler:m,updatePaymentMethod:n,reSetPaymentMethod:g,paymentMethodInit:f}};var Layer=function(a){this.init(a)};Layer.prototype={init:function(a){this.id=a.id;this.url=a.url;this.selector=a.selector;this.title=a.title;if(!this.id||!this.url||!this.selector){return}this.bindCreateEvent()},bindCreateEvent:function(){var c=this;var b="#"+c.id;var a=c.selector;$(a).click(function(){var d=$(b).length>0;if(d){c.show()}else{c.getContent(function(e){c.initContent(e);c.initPosition();c.show();c.bindCloseEvent();c.bindWindowResizeEvent()})}})},bindCloseEvent:function(){var a=this;$("[_span=close],#layer-mask").click(function(){a.close()})},bindWindowResizeEvent:function(){var a=this;$(window).resize(function(){a.initPosition()})},getContent:function(a){var b=this.url;$.ajax({type:"POST",url:b,success:function(c){if(c.success){a(c.html)}},error:function(c,e,d){}})},initContent:function(c){if($("#layer-mask").length==0){var a=[];a.push('<div id="layer-mask"></div>');$("body").prepend(a.join(""))}var b=[];b.push('<div id="'+this.id+'" class="pop-layer input-popLayer" style="display:none;">');b.push('<a href="#" class="close-layer-img"  _span="close" title="Close">Close</a>');b.push('<h3 class="layer-title">'+this.title+"</h3>");b.push('<div class="layer-content-wrapper">');b.push(c);b.push("</div>");b.push("</div>");this.content=b.join("");$("body").append(this.content)},initPosition:function(){var f=$(document).height();var g=$(document).width();var a=$(window).height();var e=$(window).width();var c=$("#"+this.id);var d=c.height();var b=c.width();c.css({position:"fixed",top:(a-d)/2,left:(e-b)/2});$("#layer-mask").css({height:f,width:g})},show:function(){$("#layer-mask").show();var a=$("#"+this.id);a.show()},close:function(){var a=$("#"+this.id);a.hide();$("#layer-mask").hide()}};var Pricing=function(C){var v=C?C:{};var s=v.subscribeData;var K;var P;var r;var J;var p;var G;var f;var w;var d;var H;var c={LEVEL:{SIZE:"size",NAME:"name",INDEX:"index"},FREQUENCY:{VALUE:"value",DISCOUNT:"discount",NAME:"name"}};var F=new LoginPopup();var N=new SignupPopup();var R=function(){L();k();m();A();e();V();F.init();N.init()};var L=function(){log(s);if(!s){alert("subscribeData can no be empty!");return}K=s.countryCode;P=s.currency;r=s.totals;J=s.pricings;p=s.levels;G=s.frequencys;w=s.selectedLevelName;d=s.selectedFrequencyName;H=s.minLicenseLevelAllowed;if(!p||!G){alert("Levels and Frequencys can no be empty!")}i();O();t();if(j()){q()}};var i=function(){f=$.map(p,function(Y,X){return Y})};var u=function(X){if(X&&(X!=K)){$.ajax({type:"POST",url:application.getRelativeGrailsContextPath()+"/pricing/reBuildSubscribeData",data:{countryCode:X,engineType:s.engineType,selectedLevelName:w,selectedFrequencyName:d,minLicenseLevelAllowed:s.minLicenseLevelAllowed},success:function(Y){s=Y;L()},error:function(Y,aa,Z){log(aa)}})}};var B=function(X,Y,aa){var Z=$("[_form=subscribeForm]");$.ajax({type:"POST",url:application.getRelativeGrailsContextPath()+"/customerLicense/preview",data:Z.serialize(),success:function(ab){var ac=ab.amount;W(ac);x(ab.currency);var ae=ab.amountWithoutTax;$("[_span=amount_without_tax]").html(ae);var ad=ab.taxAmount;$("[_span=tax]").html(ad);X()},error:function(ab,ag,ac){log(ab,ag,ac);var af="409";if(ab.status==af){var ae=JSON.parse(ab.responseText).errors;var ad=$.map(ae,function(ai,ah){return"<li>"+ai.message+"</li>"});$("[_ul=subscribe_error]").html(ad.join("")).show()}},beforeSend:function(ac,ab){$("[_ul=subscribe_error]").empty().hide();$('[_span="pricingSummary"]').hide();$("[_span=pricingLoader]").show();if(Y){Y()}},complete:function(ab,ac){$('[_span="pricingSummary"]').show();$("[_span=pricingLoader]").hide();if(aa){aa()}}})};var W=function(X){$("[_hidden_field=amount]").val(X)};var x=function(X){if(X!=P){P=X}$("[_hidden_field=currency]").val(X);$("._currency_mark").html(X)};var t=function(){$("#payFreList li").click(function(Y){var X=$(this).attr("_frequency");S(X)});S(d)};var S=function(X){d=X;$("[_frequency="+d+"]").addClass("selected").siblings().removeClass("selected");n()};var O=function(){$("#num-slider").slider({range:"min",value:1,min:1,max:f.length,slide:function(Y,Z){o(Z.value)}});var X=p[w][c.LEVEL.INDEX];h(X)};var h=function(X){$("#num-slider").slider({value:X});o(X)};var o=function(X){$("#sliderTip").hide();var Z=X==f.length;if(Z){$("#numEnd").show()}else{$("#numEnd").hide()}var Y=$(".vmNumScale:eq("+(X-1)+")");Y.addClass("selected").siblings().removeClass("selected");w=Y.attr("_level");var aa=p[w][c.LEVEL.SIZE];$("#num-slider .ui-slider-handle").html(aa);l();n()};var l=function(){$.each(G,function(Z,Y){var aa=Z;var X=0;if(J[w]&&J[w][aa]){X=J[w][aa]}$("[_frequency="+aa+"] [_span=pricing]").html(X)})};var n=function(){var X=y();$("[_span=total]").html(X)};var a=function(){var X=0;if(p[w]&&p[w][c.LEVEL.SIZE]){X=p[w][c.LEVEL.SIZE]}return X};var b=function(){return G[d][c.FREQUENCY.VALUE]};var y=function(){var X=0;if(r[w]&&r[w][d]){X=r[w][d]}return X};var T=function(){return p[w][c.LEVEL.NAME]};var D=function(){return G[d][c.FREQUENCY.NAME]};var A=function(){$("#instanceSizeForm").validate({rules:{instanceSize:{required:false,digits:true}},errorLabelContainer:"#instanceSizeError"});$("#instanceSizeForm").submit(function(){if($("#instanceSizeForm").valid()){var X=parseInt($("[_input=instanceSize]").val());var Y;$.each(p,function(aa,Z){var ac=Z;var ab=ac[c.LEVEL.SIZE];if(ab>=X){Y=ac[c.LEVEL.INDEX];return false}});if(!Y){Y=f[f.length-1][c.LEVEL.INDEX]}h(Y)}return false})};var M=function(){var X=p[w][c.LEVEL.INDEX];if(X>1){$("#noSelectedLevel").hide();return true}else{$("#noSelectedLevel").show();return false}};var j=function(){if(H){var Y=p[w][c.LEVEL.INDEX];var X=p[H][c.LEVEL.INDEX];if(Y<X){return true}}return false};var E=function(X){if(M()){F.isLogin(function(){if(j()){q()}else{X()}},function(){F.setSuccessCallbackUrl(Q());N.setSuccessCallback(U);F.showLoginDiv()})}};var e=function(){$("[_btn=modify_subscription_detail]").click(function(){$("[_input=subscribe]").attr("_modify","true");I()})};var z=function(){var Z=T();$("[_hidden_field=licenseLevelName]").val(Z);var Y=D();$("[_hidden_field=licenseFrequency]").val(Y);var aa=a();$("[_span=instanceSize]").html(aa);var X=b();$("[_span=licenseFrequencyValue]").html(X)};var U=function(){window.location.assign(Q())};var Q=function(){var X=parseURL(window.location.href);X.params.level=T();X.params.frequency=D();return X.protocol+"://"+X.host+application.getRelativeGrailsContextPath()+"/pricing/subscribe?"+decodeURIComponent($.param(X.params))+X.anchor};var q=function(){var X=p[H][c.LEVEL.SIZE];$("[_span=lowerLevelWarning]").html(X);$("#mask").show();$("#lowerLevelWarningNotice").show();g()};var k=function(){$("#closeLowerLevelWarningNotice,#noticeOkButton").click(function(){$("#mask").hide();$("#lowerLevelWarningNotice").hide()})};var g=function(){popLayerAlignedCenter("lowerLevelWarningNotice")};var m=function(){$(window).resize(function(){g()})};var V=function(){$("#downloadPricing").click(function(){var Y=parseURL(window.location.href);Y.params.level=T();Y.params.frequency=D();var X=application.getRelativeGrailsContextPath()+"/pricing/downloadPricing?"+decodeURIComponent($.param(Y.params));window.open(X)})};var I=function(){$("._step_title").removeClass("selected");$("[_step_title=slide]").addClass("selected");$("._step_title").removeClass("beforeSelected");$("._step").hide();$("[_step=slide]").show()};return{init:R,show:I,reBuildData:u,preview:B,updateSubscriptionDetailInfo:z,pricingSubmitHandler:E,getSelectedLevelName:T,getSelectedFrequencyName:D}};var QuickLogin=function(a){this.init(a)};QuickLogin.prototype={init:function(a){this.container=a.container},isLoggedIn:function(c,b){var a=this;$.ajax({type:"GET",url:application.getRelativeGrailsContextPath()+"/security/loggedInUserInfo",data:"lang="+application.getLang()+"&entryPoint=ENTRY_CUSTOMER&field=userName&field=fullName&field=isSwitched&field=switchedUserOriginalUserName&field=isDemoUser&field=isCreatedByAzureStore",success:function(d){if(d){if(c){c(d)}}else{if(b){b()}}},error:function(d,f,e){if(b){b()}}})},prepareLoggedInHTML:function(a){var b="<div class='loggedInfo'>";b+="<div class='wlUserName'>Welcome,"+a.fullName+" <img border='0' title='' alt='' src='/content/inc/img/icon-triangle.gif'><ul class='userMenu'>";if(a.isDemoUser==false){b+="<li><a _a='showProfile' href='#'>My Profile</a></li>"}b+="<li><a href='"+application.getGrailsContextPath()+"/resetPassword/forgetPassword?lang="+application.getLang()+"&userName="+a.userName+"'>Reset Password</a></li>";if(a.isSwitched){b+="<li><a id='exitSwitchedUserLink' href='#'>Resume as "+a.switchedUserOriginalUserName+"</a></li>"}else{b+="<li><a id='signOutLink' href='#'>Sign Out</a></li>"}b+="</ul></div>";b+="&nbsp;&nbsp; | &nbsp;&nbsp;<a href='"+application.getGrailsContextPath()+"/customerLicense/list?lang="+application.getLang()+"'>My Subscriptions</a>";b+="</div>";return b},bindLoggedInHTMLEventHandler:function(b){var a=this;if(b.isSwitched){$("#exitSwitchedUserLink").click(function(){application.exitSwitchedUser()})}else{$("#signOutLink").click(function(){application.signOut()})}},prepareNotLoggedInHTML:function(){var a="<div class='quick-entry' id='quickEntry'><a href='' class='login' title='Log In'>Login</a><a id='signUp' class='user' title='Sign Up Now!'>New User?</a><form method='post' id='quickLoginForm' name='quickLoginForm'><div class='login-layer' id='quickLogin' style='display: none;'><a id='closeQuickLogin' class='close-layer-img' alt='Close' title='Close'>Close</a><label for='quickUserName' class='input-label'>Your email address:</label><input type='hidden' id='quickEntryPointInput' name='entryPoint' value='ENTRY_CUSTOMER'/><input type='text' name='quickUserName' id='quickUserName' placeholder='someone@example.com' class='required email'/><a id='forgetPwLink' class='forget-pw-link'>Forget password?</a><label for='quickPassword' class='input-label'>Password:</label><input type='password' name='quickPassword' id='quickPassword' class='required'/><input type='checkbox' id='rememberMe' name='j_security_remember_me'/><label for='rememberMe' class='grey'>Remember me</label><input type='button' value='Login' id='quickLoginButton' class='button login-btn'/><hr class='hr'><span>or</span><div class='login-live-id'> Login with <img src='"+application.getContentContextPath()+"/inc/img/ic_login_with_live_id.png' alt='Windows Live ID' title='Windows Live ID' id='loginWithWindowsLive'/> </div><div id='quickLoginError'></div></div></form></div>";return a},bindNotLoggedInHTMLEventHanlder:function(){var a=new ExternalOAuth2Login();var b={lang:application.getLang()};var f=parseURL(window.location.href);if(!!f.params.engineType){b.engineType=f.params.engineType}$("#signUp").attr("href",application.getGrailsSecurityContextPath()+"/signUp/index?"+$.param(b));$("#forgetPwLink").attr("href",application.getGrailsSecurityContextPath()+"/resetPassword/forgetPassword?lang="+application.getLang());$("#forgetPwLink").attr("tabIndex","-1");var d=$("#quickLoginForm").validate({rules:{quickUserName:{required:true},quickPassword:{required:true}},messages:{quickUserName:{required:"All fields are required."},quickPassword:{required:"All fields are required."}},onkeyup:false,errorPlacement:function(g,h){if($("#quickUserName").hasClass("error")){$("#quickPassword").removeClass("error")}if($("#quickPassword").hasClass("error")){$("#quickUserName").removeClass("error")}$("#quickLoginError").removeClass("error");$("#quickLoginError").show();$("#quickLoginError").html(g)},errorElement:"label"});$(".quick-entry .login").click(function(){$(".login-layer").show();$("#quickUserName").focus();return false});$("#closeQuickLogin").click(function(){$(".login-layer").hide();d.resetForm();if($("#quickUserName").hasClass("valid")){$("#quickPassword").val("")}else{$("#quickLoginForm")[0].reset()}$("#quickUserName").removeClass("error");$("#quickPassword").removeClass("error");$("#quickLoginError").html("")});$("#quickLoginButton").live("click",function(g){c()});$("#quickPassword").live("keydown",function(g){if(g.keyCode==13){c()}});function c(){if($("#quickLoginForm").valid()){$.ajax({type:"POST",url:application.getRelativeGrailsContextPath()+"/j_security_check",data:{userName:$("#quickUserName").val(),passWord:$("#quickPassword").val(),entryPoint:$("#quickEntryPointInput").val(),j_security_remember_me:$("#rememberMe:checked").val()},success:function(j){var g=j.success;if(true==g){var i=application.getRelativeGrailsContextPath()+"/customerLicense/connectDefault";window.location.assign(i)}else{var h=j.messages;var k="";if(h.errorUserName!=null&&h.errorUserName!=undefined){k+=h.errorUserName}else{if(h.errorPassword!=null&&h.errorPassword!=undefined){k+=h.errorPassword}else{if(h.errorCredentials!=null&&h.errorCredentials!=undefined){k+=h.errorCredentials}}}$("#quickLoginError").addClass("error");$("#quickLoginError").html(k);$("#quickLoginError").show()}},error:function(g,i,h){$("#quickLoginError").addClass("error");$("#quickLoginError").html(i);$("#quickLoginError").show()}})}}var e=this;$("#loginWithWindowsLive").click(function(){a.login("WindowsLive","popup","Web")});this.bindChangeLanguageEventHanlder()},append:function(b){var a=this;this.isLoggedIn(function(d){$("#quickEntry").detach();var f=a.prepareLoggedInHTML(d);var c=$(f);c.appendTo(a.container);a.bindLoggedInHTMLEventHandler(d);var e=new Layer({id:"myProfile",url:application.getRelativeGrailsContextPath()+"/customerUser/profilePageContent",selector:"[_a=showProfile]",title:"My profile"});if(b){b(d)}},function(){var c=a.prepareNotLoggedInHTML();var d=$(c);d.appendTo(a.container);a.bindNotLoggedInHTMLEventHanlder();if(b){b()}})},bindChangeLanguageEventHanlder:function(){$("#change_lang").click(function(){var b=parseURL(window.location.href);var a=b.sourceWithoutQuery;var c=a.substring(a.length-4,a.length);if(c=="html"){if(application.getLang()=="en"){window.location.href=window.location.href.replace("/en/","/zh/")}else{if(application.getLang()=="zh"){window.location.href=window.location.href.replace("/zh/","/en/")}}}else{if(application.getLang()=="en"){b.params.lang="zh"}else{if(application.getLang()=="zh"){b.params.lang="en"}}window.location.assign(b.sourceWithoutQuery+"?"+$.param(b.params)+b.anchor)}})}};var Scaffolding=function(a){this.init(a)};Scaffolding.prototype={init:function(a){},onOneToManyAddClick:function(h,d,c,b){var f=$("table[scaffoldFor='"+d+"']");var e=f.attr("count");if(e==""){e=0}var g=$("tr[scaffoldFor='"+d+"']").filter(function(){return $(this).is(":hidden")}).clone();if(c){if(!c(f,g,e)){return}}g.attr("index",e);var a=$(g).find(":input");$.each(a,function(l,m){var j=$(m);var k=j.attr("name");k=k.replace("*","["+e+"]");j.attr("name",k);j.attr("id",k)});e++;f.attr("count",e);g.appendTo(f);g.show();if(b){b(f,g,e)}},onOneToManyDeleteClick:function(j,g,b,c){var h=$(j);var a;while(true){if(h.is("tr")&&h.attr("scaffoldFor")&&g.indexOf(h.attr("scaffoldFor"))>=0){a=h;break}else{h=h.parent()}}var i=a.attr("index");var e=a.attr("scaffoldFor");var k=$("table[scaffoldFor='"+e+"']");var f=k.attr("count");if(b){if(!b(k,a,f)){return}}var d=a.nextAll("tr").filter(function(){return $(this).attr("scaffoldFor")==e});$.each(d,function(o,r){var p=$(r);var m=p.attr("index");var l=e+"["+m+"]";var q=e+"["+(m-1)+"]";p.attr("index",(m-1));$.each($(p).find(":input"),function(u,v){var s=$(v);var t=s.attr("name");t=t.replace(l,q);s.attr("name",t);s.attr("id",t)})});if(f==""){k.attr("count",0)}f--;k.attr("count",f);a.remove();if(c){c(k,a,f)}}};var defaultScaffolding=new Scaffolding();var Scenario=function(c){var a={containerId:"",waterSpeedBase:100,waterSpeedMultiplier:800,onCompleted:{},stages:{stage_1:true,stage_2:false,stage_3:false,stage_4:false,stage_5:false,stage_6:false,stage_7:false,stage_8:false,stage_9:false,stage_10:false},stageOffset:50};var b=$.extend({},a,c);this.init(b)};Scenario.prototype={init:function(a){if(!a.containerId){alert("containerId can not be null!");return}this.containerId=a.containerId;this.waterSpeedBase=a.waterSpeedBase;this.waterSpeedMultiplier=a.waterSpeedMultiplier;this.stages=a.stages;this.stageOffset=a.stageOffset;this.onCompleted=a.onCompleted;this.waterTimer=false;this.currentWater=0;this.stoped=false;this.paused=false;this.animating=false},startAnimation:function(){this.startWater();this.bindStageWaypointEvent()},stopAnimation:function(){this.stopWater();this.destroyStageWaypointEvent()},startWater:function(){var a=this;a.stoped=false;a.animateWater(a.currentWater)},stopWater:function(){var b=this;b.stoped=true;var a=b.getCurrentWater();a.stop(true);if(b.isDataJoint(a)){b.getNextWater().stop(true)}b.animating=false},pauseWater:function(){this.paused=true},continueWater:function(){this.paused=false;this.animateWater()},getCurrentWater:function(){return this.getWater(this.currentWater)},getNextWater:function(){return this.getWater(this.currentWater+1)},getWater:function(a){var b=$("#"+this.containerId);return b.find(".water").eq(a)},animateWater:function(){var c=this;if(c.stoped||c.paused||c.animating){return}var b=c.getCurrentWater();if(b!==undefined){var a=b.closest(".stage").attr("_stage");if(a===undefined){c.pauseWater();return}if(c.stages[a]||c.isLastStage(a)){c.animate(b);if(c.isDataJoint(b)){var d=c.getNextWater();c.animate(d)}}else{c.pauseWater()}}else{return}},isLastStage:function(b){var d=$("#"+this.containerId);var c=d.find(".stage").length;var a=d.find("[_stage="+b+"]").index();return(a+1==c)},animate:function(c,k,f){var g=this;var d=g.currentWater;if(c.is(":visible")){var i=(c.hasClass("x"))?"width":"height";var e=c.closest(".tube");var j=(i=="width")?e.width():e.height();var h=(i=="width")?c.width():c.height();var a=j-h;var b=Math.floor((a/g.waterSpeedBase)*g.waterSpeedMultiplier);var k={};k[i]="100%";var f={duration:b,easing:"linear",queue:false,complete:function(){g.currentWater=g.currentWater+1;g.animating=false;var l=$(this).attr("_on_completed");var m=g.onCompleted[l];if($.isFunction(m)){g.pauseWater();m(g)}else{if(!g.isDataJoint(c)){g.animateWater()}}}};g.animating=true;c.animate(k,f)}else{g.stopWater()}},isDataJoint:function(a){return a.attr("data-joint")=="true"},bindStageWaypointEvent:function(){var a=this;var b=$("#"+a.containerId);$.each(a.stages,function(e,d){var c=b.find('[_stage="'+e+'"]');c.waypoint(function(f){if($(this).is(":visible")){if(f=="down"){c.find(".feature").fadeIn(1000);a.stages[e]=true;a.continueWater()}}},{offset:a.stageOffset+"%"})})},destroyStageWaypointEvent:function(){var a=this;var b=$("#"+a.containerId);$.each(a.stages,function(e,d){var c=b.find('[_stage="'+e+'"]');c.waypoint("destroy")})}};var SignupPopup=function(a){var j=a?a:{};var i=function(){e();f();c();h()};var e=function(){$("#signupBtn").live("click",function(k){$("#logForSub").show();$("#loginDiv").hide();$("#signupDiv").show();b()})};var f=function(){$("#signup").live("click",function(l){if($("#acceptBox").get(0).checked){$("#firstName,#lastName").attr("placeholder","");if($("#firstName").val()=="First Name"){$("#firstName").val("")}if($("#lastName").val()=="Last Name"){$("#lastName").val("")}var k=$("#signupForm");if(k.valid()){$.ajax({type:"POST",url:application.getRelativeGrailsContextPath()+"/signUp/signUp",data:k.serialize(),success:function(n){var m=n.success;if(true==m){d()}},error:function(m,o,n){log(o)}})}}else{$("#error_accept_box").empty();$("#error_accept_box").removeClass();$("#error_accept_box").addClass("error");$("#error_accept_box").append($("#signup_gsp_read_terms").val())}})};var c=function(){$("#acceptBox").click(function(){if($("#acceptBox").get(0).checked){$("#error_accept_box").empty();$("#error_accept_box").removeClass()}else{$("#error_accept_box").empty();$("#error_accept_box").removeClass();$("#error_accept_box").addClass("error");$("#error_accept_box").append($("#signup_gsp_read_terms").val())}})};var d=j.successCallback;var g=function(k){d=k};var b=function(){popLayerAlignedCenter("logForSub")};var h=function(){$(window).resize(function(){b()})};return{init:i,setSuccessCallback:g}};var SolutionMenu=function(f){var k={id:"productMenu"};var u=$.extend({},k,f);var h=$("#"+u.id);var x=[];var c=u.hash;var l=true;var s=function(){g();t();v();i();q();r();o();w()};var g=function(){h.find("li:not([_scroll_to=scenario])").each(function(A,B){var z=$(this);var y=z.attr("_scroll_to");x.push(y)})};var t=function(){$.each(x,function(y,z){$("#"+z).waypoint(function(A){if($(this).is(":visible")){p(z)}},{offset:45})})};var v=function(){h.find("li:not([_scroll_to=scenario])").click(function(){var y=$(this);var z=y.attr("_scroll_to");m(z,false);a(z)})};var m=function(z,y){l=y;c.set("menu",z);googleAnalyticsTrackPageview(window.location.pathname+window.location.hash)};var w=function(){$(window).hashchange(function(){var y=c.get("menu");if(y){if(l){a(y)}else{l=true}}})};var a=function(y){p(y);b(y)};var p=function(y){h.find("li").removeClass("selected");h.find("li[_scroll_to="+y+"]").addClass("selected");$(".article").show();$("#scenario").hide()};var b=function(z){if(!$("#"+z).is(":visible")){return}j(false);var y=$("#"+z).offset().top;y-=e();$("html, body").animate({scrollTop:y},{duration:600,easing:"linear",complete:function(){j(true)}})};var i=function(){h.find(".menu-title").click(function(){if($(this).is(":visible")){$("html, body").animate({scrollTop:0},"normal")}})};var q=function(){$("#menuWrapper").waypoint(function(y){if(y=="down"){h.addClass("fixed")}else{h.removeClass("fixed")}})};var r=function(){if(d($("footer"))){$(".actions").removeClass("fixed")}else{$(".actions").addClass("fixed")}};var o=function(){$(window).bind("scroll resize",function(){r()})};var e=function(){if(h.hasClass("fixed")){return h.outerHeight(true)}else{return h.outerHeight(true)-10}};var j=function(y){$.each(x,function(z,A){$("#"+A).waypoint(y?"enable":"disable")})};var d=function(z){var B=$(window);var y={top:B.scrollTop(),left:B.scrollLeft()};y.right=y.left+B.width();y.bottom=y.top+B.height();var A=z.offset();A.right=A.left+z.outerWidth();A.bottom=A.top+z.outerHeight();return(!(y.right<A.left||y.left>A.right||y.bottom<A.top||y.top>A.bottom))};var n=function(){return h};return{init:s,getMenuOuterHeight:e,getMenu:n,scrollToSelectedMenuItem:b}};var SolutionScenarios=function(p){var i=this;var M={id:"scenario-tabs",scenarioContainerId:"scenario-contents"};var C=$.extend({},M,p);var a=$("#"+C.id);var I=$("#"+C.scenarioContainerId);var J=C.menu;var F=C.hash;var o=C.defaultScenario;var n=C.scenarios;var t;var k;var z=false;var w={};var E=true;var K=function(){};var f=0;var G=function(){d();g();j();m();v();H()};var H=function(){$("._free_trial").live("click",function(){var N=$("#_free_trial").attr("href");window.location.assign(N)})};var d=function(){$.each(n,function(N,O){w[O.containerId]=O})};var g=function(){J.getMenu().find("li[_scroll_to=scenario]").click(function(){if(l()){r(o)}else{q();B(t);y();J.scrollToSelectedMenuItem("scenario")}})};var r=function(N){a.find('li[_scenario="'+N+'"]').click()};var j=function(){a.find("li").hover(function(){$(this).find(".selected-bg").css("height","100%").show()},function(){var N=$(this).hasClass("selected");if(!N){$(this).find(".selected-bg").hide()}})};var m=function(){$.waitForImages.hasImgProperties=["background"];$("#scenario-tabs li , #scenario-contents .choice-b").live("click",function(){var N=$(this).attr("_scenario");if(N==k&&z){return}E=false;h(N)})};var v=function(){$(window).hashchange(function(){var N=F.get("scenario");if(N){if(E){h(N)}else{E=true}}})};var h=function(N){q();A();B(N);u(N);L(N)};var q=function(){var N=J.getMenu();N.find("li").removeClass("selected");N.find("li[_scroll_to=scenario]").addClass("selected");$(".article").hide();$("#scenario").show()};var B=function(N){k=N;F.set("scenario",N);googleAnalyticsTrackPageview(window.location.pathname+window.location.hash)};var A=function(){var N=s(t);if(N){N.stopAnimation()}};var y=function(){var N=s(t);if(N){N.startAnimation()}};var u=function(N){a.find("li .selected-bg").hide();a.find('li[_scenario="'+N+'"]').find(".selected-bg").css("height","100%").show();a.find("li").removeClass("selected");a.find('li[_scenario="'+N+'"]').addClass("selected")};var L=function(O){var N=I.find("#"+O).length>0;if(!N){$.ajax({url:"scenarios/"+O+".html",success:function(P){I.append(P).hide().waitForImages(function(){setTimeout(function(){b(O)},f)})},beforeSend:function(){z=true;D(O)}})}else{b(O)}};var D=function(N){if(k!=N||!z){return}var O=a.find('li[_scenario="'+N+'"]').find(".selected-bg");O.css("height",0);if(O.is(":visible")){O.animate({height:"100%"},{duration:1000,queue:false,complete:function(){D(N)}})}};var e=function(){z=false;var N=a.find('li[_scenario="'+scenario+'"]').find(".selected-bg");N.stop(true,true)};var b=function(N){if(N!=k){return}e();I.find("li.scenario-item").hide();I.find("#"+N).show();I.fadeIn(function(){var O=s(k);if(O){setTimeout(function(){x(O);O.startAnimation();t=k},500)}})};var x=function(O){if(!O||!$("#scenario").is(":visible")){return}var P=$("#scenario").offset().top;var N=O.getCurrentWater();if(N.length>0){P=N.offset().top}P-=J.getMenuOuterHeight();$("html, body").animate({scrollTop:P},{duration:1000,easing:"linear"})};var s=function(N){return w[N]};var l=function(){return !I.has("li").length};var c=function(N){f=N};return{init:G,clickScenario:r,startCurrentScenarioAnimation:y,stopCurrentScenarioAnimation:A,setLoadingTimeSpan:c}};var Hash=function(){var b=function(c,d){var e=c+"="+d;window.location.hash=e};var a=function(c){var d=window.location.hash;if(d.indexOf(c+"=")>0){return d.split("=")[1]}};return{set:b,get:a}};var Solution=function(c){var a={scenarios:{}};var b=$.extend({},a,c);this.init(b)};Solution.prototype={init:function(a){this.hash=new Hash();this.menu=new SolutionMenu({hash:this.hash});this.scenarios=new SolutionScenarios({hash:this.hash,menu:this.menu,scenarios:a.scenarios,defaultScenario:a.defaultScenario});this.menu.init();this.scenarios.init();this.checkLocationHash();this.bindWaterFlowToggleEvent();this.bindsLoadingTimeSpanToggleEvent()},checkLocationHash:function(){var a=this.hash.get("scenario");if(a){this.scenarios.clickScenario(a)}},bindWaterFlowToggleEvent:function(){var a=this;$("#waterFlowToggle").toggle(function(){a.stopCurrentScenarioAnimation();$(this).html("Continue")},function(){a.startCurrentScenarioAnimation();$(this).html("Stop")})},bindsLoadingTimeSpanToggleEvent:function(){var a=this;$("#loadingTimeSpan").toggle(function(){a.scenarios.setLoadingTimeSpan(3000);$(this).html("Normal Network")},function(){a.scenarios.setLoadingTimeSpan(0);$(this).html("Slow Network")})},stopCurrentScenarioAnimation:function(){this.scenarios.stopCurrentScenarioAnimation()},startCurrentScenarioAnimation:function(){this.scenarios.startCurrentScenarioAnimation()}};var Subscribe=function(k){var e=k?k:{};var s=function(){var I=function(){N();x();t();G();v()};var v=function(){$("#billTo\\.country").change(function(){var P=this.value;J(P,"billTo")})};var G=function(){$("#soldTo\\.country").change(function(){var P=this.value;J(P,"soldTo")})};var J=function(Q,P,S){var R='<input type="text" placeholder="State/Province/Region" name="state" id="'+P+'.state" style="width:168px;"/>';$.ajax({type:"POST",url:application.getRelativeGrailsContextPath()+"/geography/findSubdivisions",data:{countryCode:Q},success:function(T){var W=T.length>0;if(W){var V=[];V.push('<select name="state" id="'+P+'.state" class="selector" style="width:184px;">');V.push('<option value="" selected="selected">-State/Province/Region-</option>');$.each(T,function(Y,X){V.push('<option value="'+X.code+'">'+X.name+"</option>")});V.push("</select>");R=V.join("")}$("[_span="+P+"_state]").html(R);var U=$("#"+P+"Form [name=state]");if(W){U.rules("add",{required:true})}else{U.rules("remove","required");U.placeholder()}if(S){S()}},error:function(T,V,U){}})};var w=function(Q,P){if(B()){F(Q);if(H()){K()}z(P)}};var F=function(P){y("soldTo");P()};var z=function(P){y("billTo");$("[_hidden_field=billToSameAsSoldTo]").val(H());P()};var K=function(){var P=$("#soldToForm :input");P.each(function(S,T){var R=T.name;var V=T.value;if(R=="state"){var U=$(T).clone();U.attr("id","billTo.state");$("[_span=billTo_state]").html(U);if($(U).is("select")){$("#billToForm [name=state]").rules("add",{required:true})}else{$("#billToForm [name=state]").rules("remove","required")}}if($(T).is("select")){L("billToForm",R,V)}if(V){var Q=$("#billToForm [name="+R+"]");Q.val(V)}})};var L=function(R,S,Q){var P=$("#"+R+" [name="+S+"]");P.val(Q);P.find("option[value="+Q+"]").attr("selected",true)};var y=function(R){var T=["address1","city","state","postalCode","country"];var S={};var Q=$("#"+R+"Form :input");Q.each(function(V,W){var U=W.name;var X=W.value;if(X){$('[_hidden_field="'+R+"."+U+'"]').val(X);if($.inArray(U,T)>=0){if($(W).is("select")){S[U]=$(W).find("option:selected").text()}else{S[U]=X}}else{$('[_span="'+R+"."+U+'"]').html(X)}}});var P=$.map(T,function(V,U){return S[V]});$('[_span="'+R+'.address"]').html(P.join(", "))};var B=function(){var Q=$("#soldToForm").valid();if(H()){return Q}else{var P=$("#billToForm").valid();return Q&&P}};var N=function(){$("[_btn=modify_subscriber]").click(function(){$("[_div=display_subscriber]").hide();$("[_div=edit_subscriber]").show();$("[_btn=subscriber_operation_btns]").show()})};var x=function(){$("[_btn=cancel_modify_subscriber]").click(function(){C();E()})};var C=function(){var P=$("[_form=subscribeForm] [_hidden_field=billToSameAsSoldTo]").val();u(P=="true");var Q=$("[_div=subscribeForm_subscriber] :hidden");Q.each(function(S,T){var U=T.name.split(".")[0];var R=T.name.split(".")[1];var V=T.value;if(V){if(R=="state"){var X=$('[_div=subscribeForm_subscriber] [name="'+U+'.country"]').val();var W=U+"Form";J(X,U,function(){L(W,R,V)})}var Y=$("#"+U+"Form [name="+R+"]");if(Y.is("select")){Y.find("option[value="+V+"]").attr("selected",true)}Y.val(V)}})};var E=function(){$("[_div=display_subscriber]").show();$("[_div=edit_subscriber]").hide();$("[_btn=subscriber_operation_btns]").hide()};var A=function(){$("#soldToForm")[0].reset();$("#billToForm")[0].reset();$("#soldToForm").validate().resetForm();$("#billToForm").validate().resetForm();J("","soldTo");u(true);$("#soldToForm input[placeholder]").placeholder();$("#billToForm input[placeholder]").placeholder()};var H=function(){var P=$("#billToSameAsSoldTo").get(0).checked;if(P){return true}return false};var t=function(){$("#billToSameAsSoldTo").click(function(){K();u(this.checked)})};var u=function(P){$("#billToSameAsSoldTo").attr("checked",P);if(P){$("[_div=billToContent]").hide();$("[_lable=_billToSameAsSoldTo]").show()}else{$("[_div=billToContent]").show();$("[_lable=_billToSameAsSoldTo]").hide()}};var D=function(){var P={emailAdd:"email",firstName:"firstName",lastName:"lastName",phone:"phone"};$.ajax({type:"GET",url:application.getRelativeGrailsContextPath()+"/security/loggedInUserInfo",data:{entryPoint:"ENTRY_CUSTOMER"},success:function(Q){if(Q){log(Q);$.each(P,function(S,R){var T=Q[S];if(T){$("#soldToForm input[name="+R+"]").val(T).removeClass("placeholder").valid()}})}},error:function(Q,S,R){}})};var M=function(){return $("#soldToForm [name=country]").val()};var O=function(){$("._step_title").removeClass("selected");$("[_step_title=subscriberInfo]").addClass("selected");$("._step_title").removeClass("beforeSelected");$("[_step_title=slide]").addClass("beforeSelected");$("._step").hide();$("[_step=subscriber]").show()};return{init:I,show:O,loginInfoSynchronizeToSoldTo:D,resetSubscriber:A,updateSubscriberInfo:w,modifySubscriberCallback:E,getSoldToCountryCode:M}};var j=function(){var v=function(){u()};var u=function(){$("#serviceAgreement").click(function(){var w=$("#serviceAgreement").get(0).checked;if(w){$("[_btn=summary_submit]").removeAttr("disabled").removeClass("disabledBtn").addClass("highlightBtn");$("[_div=serviceAgreementError]").hide()}else{$("[_btn=summary_submit]").attr("disabled","disabled").removeClass("highlightBtn").addClass("disabledBtn");$("[_div=serviceAgreementError]").show()}})};var t=function(){$("._step_title").removeClass("selected");$("[_step_title=summary]").addClass("selected");$("._step_title").removeClass("beforeSelected");$("[_step_title=paymentMethodInfo]").addClass("beforeSelected");$("._step").hide();$("[_step=summary]").show()};return{init:v,show:t}};var i;var a;var l;var d;var p=function(){i=new Pricing(e);a=new s();l=new PaymentMethod();d=new j();i.init();a.init();l.init();d.init();n();m();c();h();g();q();r();b();o()};var n=function(){$("[_input=subscribe]").click(function(){var t=this;i.pricingSubmitHandler(function(){i.updateSubscriptionDetailInfo();var u=$(t).attr("_modify")=="true";if(u){d.show();$(t).attr("_modify","false")}else{a.loginInfoSynchronizeToSoldTo();a.show()}})})};var m=function(){$("[_btn=confirm_modify_subscriber]").click(function(){var t=$(this);var u=t.val();a.updateSubscriberInfo(function(){i.reBuildData(a.getSoldToCountryCode())},function(){i.preview(function(){a.modifySubscriberCallback()},function(){t.val(u+"...");t.next().show()},function(){t.val(u);t.next().hide()})})})};var c=function(){$("[_btn=subscriber_submit]").click(function(){var t=$(this);var u=t.val();a.updateSubscriberInfo(function(){i.reBuildData(a.getSoldToCountryCode())},function(){i.preview(function(){l.paymentMethodInit();l.show()},function(){t.val(u+"...");t.next().show()},function(){t.val(u);t.next().hide()})})})};var h=function(){$("[_btn=subscriber_back]").click(function(){i.show();a.resetSubscriber()})};var g=function(){$("[_btn=payment_method_submit]").click(function(){l.paymentMethodSubmitHandler(function(t){l.updatePaymentMethod(t);d.show()})})};var q=function(){$("[_btn=payment_method_back]").click(function(){a.show();l.reSetPaymentMethod()})};var r=function(){$("[_btn=summary_submit]").click(function(){var v=$("#serviceAgreement").get(0).checked;if(v){var u=new Inprogress({id:"subscriptionProgress"});var t=$("[_form=subscribeForm]");$.ajax({type:"POST",url:application.getRelativeGrailsContextPath()+"/customerLicense/subscribe",data:t.serialize(),success:function(z,A,y){log(z,A,y);var x="X-Window-Location";var w=y.getResponseHeader(x);log(w);window.location.assign(w)},error:function(x,C,y){log(x,C,y);var B="409";if(x.status==B){var A=JSON.parse(x.responseText).errors;var z=$.map(A,function(E,D){return"<li>"+E.message+"</li>"});$("[_ul=subscribe_error]").html(z.join("")).show()}else{var w=application.getRelativeGrailsContextPath()+"/error/exception";window.location.assign(w)}},beforeSend:function(x,w){u.show()},complete:function(w,x){u.hide()}})}else{$("[_div=serviceAgreementError]").show()}})};var b=function(){$("[_btn=summary_back]").click(function(){$("[_btn=payment_method_operation_btns]").hide();l.paymentMethodInit();l.show()})};var o=function(){var t=k.subscribeStep;switch(t){case"1":i.show();break;case"2":i.updateSubscriptionDetailInfo();a.loginInfoSynchronizeToSoldTo();a.show();break;case"3":l.show();break;case"4":d.show();break;default:i.show()}};var f=function(){return l};return{init:p,getPaymentMethod:f}};var TaglibSupport=function(a){this.init(a)};TaglibSupport.prototype={init:function(a){},onActionSubmitLinkClick:function(e,f,d){var c=this._getFormByNameOrFirtForm(e);if(f&&$.trim(f)!=""){var b=$("<input type='hidden'/>").attr("name","_action_"+f).val(f).appendTo(c)}var a;if(d&&$.trim($(d).attr("params"))){a=new Array();$.each($(d).attr("params").split(","),function(j,k){var h=k.split(":");var g=$("<input type='hidden'/>").attr("name",h[0]).val(h[1]).appendTo(c);a.push(g)})}c.submit();if(a&&a.length>0){$.each(a,function(g,h){h.remove()})}if(f&&$.trim(f)!=""){b.remove()}},onActionSubmitButtonClick:function(d,e,c){var b=this._getFormByNameOrFirtForm(d);if(e&&$.trim(e)!=""){var a=$("<input type='hidden'/>").attr("name","_action_"+e).val(e).appendTo(b)}b.submit();if(e&&$.trim(e)!=""){a.remove()}return false},_getFormByNameOrFirtForm:function(b){var a;if(b&&$.trim(b)!=""){a=$("#"+b)}else{a=$("form:first")}return a},onSortableColumnClick:function(e,g,d,a){var c=this._getFormByNameOrFirtForm(e);var f=$("input[name='sort']",c);var b=$("input[name='order']",c);if(f.length==0||b.length==0){alert("sort input or order input does not exist, sort may not work correctly!")}if($.trim(d)){f.val(d);b.val(a)}this.onActionSubmitLinkClick(e,g)},resetSortableColumnHidden:function(c){var b=this._getFormByNameOrFirtForm(c);var d=$("input[name='sort']",b);var a=$("input[name='order']",b);d.val("");a.val("")},onPaginatePageSelect:function(e,f,g,a){var d=this._getFormByNameOrFirtForm(e);var b=$("input[name='offset']",d);var c=$("input[name='max']",d);if(b.length==0){alert("offset input does not exist, sort may not work correctly!")}b.val(g);c.val(a);this.onActionSubmitLinkClick(e,f)},resetPaginateHidden:function(d){var c=this._getFormByNameOrFirtForm(d);var a=$("input[name='offset']",c);var b=$("input[name='max']",c);a.val("0");b.val("0")}};var taglibSupport=new TaglibSupport();var TermsOfUseAccepter=function(a){this.init(a)};TermsOfUseAccepter.prototype={init:function(a){this.acceptCheckbox=a.acceptCheckbox;this.notAcceptedErrorContainer=a.notAcceptedErrorContainer;this.notAcceptedErrorMessage=a.notAcceptedErrorMessage;var b=this;this.acceptCheckbox.click(function(){if(b.isAccepted()){b.hideNotAcceptedError()}else{b.showNotAcceptedError()}})},isAccepted:function(){return this.acceptCheckbox.is(":checked")},showNotAcceptedError:function(){this.notAcceptedErrorContainer.empty();this.notAcceptedErrorContainer.removeClass();this.notAcceptedErrorContainer.addClass("error");this.notAcceptedErrorContainer.append(this.notAcceptedErrorMessage)},hideNotAcceptedError:function(){this.notAcceptedErrorContainer.empty();this.notAcceptedErrorContainer.removeClass()}};function submitHostedPage(a){var b=document.getElementById(a).src+"#"+encodeURIComponent(document.location.href);document.getElementById(a).src=b;ZXD.postMessage("submit",b,document.getElementById(a).contentWindow);return false}var ZXD=function(){var e,d,b=1,c,a=this;return{postMessage:function(f,h,g){if(!h){return}g=g||parent;if(a.postMessage){g.postMessage(f,h.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}else{if(h){g.location=h.replace(/#.*$/,"")+"#"+(+new Date)+(b++)+"&"+f}}},receiveMessage:function(g,f){if(a.postMessage){if(g){c=function(h){if((typeof f==="string"&&h.origin!==f)||(Object.prototype.toString.call(f)==="[object Function]"&&f(h.origin)===!1)){return !1}g(h)}}if(a.addEventListener){a[g?"addEventListener":"removeEventListener"]("message",c,!1)}else{a[g?"attachEvent":"detachEvent"]("onmessage",c)}}else{e&&clearInterval(e);e=null;if(g){e=setInterval(function(){var i=document.location.hash,h=/^#?\d+&/;if(i!==d&&h.test(i)){d=i;g({data:i.replace(h,"")});clearInterval(e)}},100)}}}}}();